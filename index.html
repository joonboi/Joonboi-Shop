<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" type="image/png" href="/icons/favicon.png" />
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Joonboi Plex Requester</title>
  <link rel="stylesheet" href="style.css"/>
  <link rel="manifest" href="manifest.json"/>
  <meta name="theme-color" content="#1DB954"/>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js')
          .then(reg => console.log('Service Worker registered', reg))
          .catch(err => console.error('Service Worker registration failed', err));
      });
    }
  </script>
</head>
<body>
  <div class="container">
    <img
      src="https://cdn1.iconfinder.com/data/icons/roundettes-for-os-x-vol-vi/512/Plex-01-1024.png"
      alt="Joonboi Plex Requester"
      id="logo"
      class="logo"
      style="cursor:pointer;"
      onclick="adminLoginPrompt()"
    />

    <h1>Joonboi Plex Requester</h1>

    <form id="request-form">
      <div class="radio-group">
        <label><input type="radio" name="mediaType" value="movie" checked> Movie</label>
        <label><input type="radio" name="mediaType" value="tv"> TV Show</label>
      </div>
<!-- Admin-only: X-Movie -->
<div id="xmovie-radio" class="hidden">
  <label><input type="radio" name="mediaType" value="xmovie"> X-Movie</label>
</div>

<!-- 3D Checkbox (only shown if mediaType=movie & tag=movies) -->
<div id="3d-container" class="hidden">
  <label><input type="checkbox" id="is3D"> Is 3D Available?</label>
</div>


      <label for="tag">Select Tag:</label>
      <select id="tag" required>
        <option value="">-- Choose a tag --</option>
      </select>

      <label for="title">Title:</label>
      <input type="text" id="title" placeholder="e.g. Absolute Power" required />

      <label for="year">Year:</label>
      <input type="number" id="year" placeholder="e.g. 1997" required />

      <button type="submit">Search</button>
    </form>

    <div id="results"></div>
    <div id="message" style="margin-top:10px; color: #2ecc71; font-weight: bold;"></div>

    <!-- 🔐 Admin Mode Section -->
    <div id="admin-section" class="hidden" style="margin-top: 30px; border-top: 1px solid #444; padding-top: 20px;">
      <h2>Admin Mode</h2>
      <p>You are now in admin mode. More tools coming soon...</p>
      <button onclick="exitAdminMode()">Exit Admin Mode</button>
    </div>
  </div>

  <!-- 🔐 Password Modal -->
  <div id="passwordModal" class="modal hidden">
    <div class="modal-content">
      <label for="adminPassword">Enter admin password:</label>
      <input type="password" id="adminPassword" autocomplete="off" />
      <div class="modal-buttons">
        <button id="passwordSubmit">Submit</button>
        <button id="passwordCancel">Cancel</button>
      </div>
    </div>
  </div>

  <script>
    function adminLoginPrompt() {
      document.getElementById("passwordModal").classList.remove("hidden");
      document.getElementById("adminPassword").value = '';
    }

    function exitAdminMode() {
      document.getElementById("admin-section").classList.add("hidden");
      alert("Exited admin mode.");
    }

    document.getElementById("passwordSubmit").addEventListener("click", async () => {
      const password = document.getElementById("adminPassword").value;
      if (!password) return;

      try {
        const response = await fetch("/api/admin/login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ password }),
        });

        if (response.ok) {
          document.getElementById("passwordModal").classList.add("hidden");
          document.getElementById("admin-section").classList.remove("hidden");
        } else {
          alert("Incorrect password.");
        }
      } catch (error) {
        console.error(error);
        alert("Failed to verify password.");
      }
    });

    document.getElementById("passwordCancel").addEventListener("click", () => {
      document.getElementById("passwordModal").classList.add("hidden");
    });
  </script>

  <script src="script.js"></script>
</body>
</html>



